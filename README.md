# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –æ–ø—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω–æ–π –ª–∏—Ç–æ–≥—Ä–∞—Ñ–∏–∏

---

## –í–≤–µ–¥–µ–Ω–∏–µ

–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–æ—Ç–æ–ª–∏—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –æ–ø—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏ (Optical
Proximity Correction, OPC) –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–∏ —Ç–æ—á–Ω–æ–≥–æ
–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø–æ–¥–ª–æ–∂–∫–µ. –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
**OPC**, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö, —Ç—Ä–µ–±—É—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∏
–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç. –° —Ä–∞–∑–≤–∏—Ç–∏–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –ø–æ—è–≤–∏–ª–∏—Å—å –Ω–æ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã,
—Å–ø–æ—Å–æ–±–Ω—ã–µ –ø–æ–≤—ã—Å–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å **OPC**. –û–¥–Ω–∏–º –∏–∑ —Ç–∞–∫–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤
—è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á –ø–æ–ø–∞—Ä–Ω–æ–≥–æ
–ø–µ—Ä–µ–Ω–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (**paired image-to-image translation**)[1]. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ
–∑–∞–¥–∞—á—É **OPC** –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –∑–∞–¥–∞—á—É –æ–±—É—á–µ–Ω–∏—è —Å —É—á–∏—Ç–µ–ª–µ–º, –≥–¥–µ –º–æ–¥–µ–ª—å
–≥–ª—É–±–æ–∫–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
—Ç–æ–ø–æ–ª–æ–≥–∏–∏ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∏–µ
–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–π –∏–∑ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏. –û–ø–∏—Å–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω
–≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ.


–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–º –ø—É—Ç—ë–º –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ GAN –Ω–µ –¥–∞—ë—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø—Ä–∏ —ç—Ç–æ–º –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Ä–∞—Å—Ç—ë—Ç. 


üí° **–†–µ—à–µ–Ω–∏–µ**: –æ–±—É—á–µ–Ω–∏–µ "–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤" –¥–ª—è –∑–∞–¥–∞—á–∏ –ø–æ–ø–∞—Ä–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –†–µ—à–µ–Ω–∏–µ: –æ–±—É—á–µ–Ω–∏–µ ¬´–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤¬ª –¥–ª—è –∑–∞–¥–∞—á–∏ –ø–æ–ø–∞—Ä–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü–æ–¥ —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ–¥—Ö–æ–¥—è—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –º–æ–¥–µ–ª–∏ –∏–∑ DL-–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –ø–æ —Ç–µ–º–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –ª–∏—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –Ω–æ —Ç–∞–∫–∂–µ –∏ –ª—é–±—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∑–∞–¥–∞—á —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.

## –î–∞—Ç–∞—Å–µ—Ç

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–∞–±–æ—Ä —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ª–æ—è
–º–µ—Ç–∞–ª–ª–æ–≤ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ **32 –Ω–º**[1], –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π
–æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π. –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –±—ã–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤
–±–∏–Ω–∞—Ä–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º **1024x1024 px**, –≥–¥–µ –∫–∞–∂–¥—ã–π –ø–∏–∫—Å–µ–ª—å
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–±–ª–∞—Å—Ç–∏ $1–Ω–º^{2}$.

`–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ`: –±–∏–Ω–∞—Ä–Ω—ã–µ –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 1024x1024 px. –ß—ë—Ä–Ω—ã–π —Ü–≤–µ—Ç ‚Äì —Ñ–æ–Ω. –ë–µ–ª—ã–π —Ü–≤–µ—Ç ‚Äì –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç —Ç–æ–ø–æ–ª–æ–≥–∏–∏ ‚Äì –ø–æ–ª–∏–≥–æ–Ω.

`–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ`: –±–∏–Ω–∞—Ä–Ω—ã–µ –æ–¥–Ω–æ–∫–∞–Ω–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 1024x1024. –ß—ë—Ä–Ω—ã–π —Ü–≤–µ—Ç ‚Äì —Ñ–æ–Ω. –ë–µ–ª—ã–π —Ü–≤–µ—Ç ‚Äì –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç —Ç–æ–ø–æ–ª–æ–≥–∏–∏ ‚Äì –ø–æ–ª–∏–≥–æ–Ω.

`–§–æ—Ä–º–∞ —Ç–µ–Ω–∑–æ—Ä–∞`: [batch_size, 1, 1024, 1024]

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —ç—Ç–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É—é—â–∞—è –Ω–µ–∫–∏–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ–¥–æ–±–Ω–æ —Ç–æ–º—É –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ CycleGAN


## –ú–æ–¥–µ–ª–∏

–í –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –≥–ª—É–±–æ–∫–∏—Ö
–Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –æ–ø—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏. 

–ë—ã–ª–∞ –∏—Å–æ–ª—å–∑–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª–∏ –∏–∑ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –ø–æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –ª–∏—Ç–æ–≥—Ä–∞—Ñ–∏–∏
**DAMO** (Deep Agile Mask Optimization, –±–µ–∑ –ª–∏—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ª–æ—Å—Å–æ–≤ –∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ UNet)[2], **CFNO** (Convolutional Fourier
Neural Operator)[3], –∞ —Ç–∞–∫–∂–µ –º–æ–¥–µ–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è –¥–ª—è –∑–∞–¥–∞—á —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚Äì **PSPnet** (Pyramid Scene Parsing Network)[4], **MANet**
(Multi-Attention Network)[5], **UperNet**[6].

–í –∫–∞—á–µ—Å—Ç–≤–µ –±–µ–π–∑–ª–∞–π–Ω–∞ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –º–æ–¥–µ–ª–∏ DAMO. –ë—ã–ª–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏, –æ–±—É—á–µ–Ω–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏. 

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –¥–ª—è –º–æ–¥–µ–ª–µ–π `PSPNet`, `MANet`, `UPerNet` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≥–æ—Ç–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `segmentation-models-pytorch`.

<details><summary>–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:</summary>
  
- `DAMO generator (skip connections ‚Äì concat)` ‚Äì –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è, –∫—É–¥–∞ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–æ–∏ skip-connections, –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—â–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äú–≤–æ—Å—Ö–æ–¥—è—â–µ–≥–æ‚Äù –ø—É—Ç–∏ —Å –∫–∞—Ä—Ç–∞–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äú–Ω–∏—Å—Ö–æ–¥—è—â–µ–≥–æ‚Äù –ø—É—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–Ω–µ–µ –∏–∑–≤–ª–µ—á—ë–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –≠—Ç–æ –¥–∞—ë—Ç –ª—É—á—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –≤–∑–∞–∏–º–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ñ–∏–≥—É—Ä –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. 
  
- `DAMO generator (skip connections ‚Äì add)` ‚Äì –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –ø—É–Ω–∫—Ç—É, —Ç–æ–ª—å–∫–æ –≤–º–µ—Å—Ç–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è —Å–ª–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞–º —É–¥–∞—ë—Ç—Å—è —Å–æ–∫—Ä–∞—Ç–∏—Ç—å —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º
  
- `Convolutional Fourier Neural Operator (CFNO)` ‚Äì –º–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ–Ω–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–≤—ë—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏ —Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –§—É—Ä—å–µ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ª–∞–≤–ª–∏–≤–∞–Ω–∏—è –¥–∞–ª—å–Ω–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –û—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á —Å —á–∞—Å—Ç–Ω—ã–º–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –≤ –Ω–∞—É—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö –∏ –∑–∞–¥–∞—á–∞—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è.

- `Pyramid Scene Parsing Network (PSPNet)` ‚Äì –º–æ–¥–µ–ª—å –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —É–ª—É—á—à–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∏—Ä–∞–º–∏–¥–∞–ª—å–Ω–æ–≥–æ –ø—É–ª–∞ (pyramid pooling module) –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ä–∞–∑–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–æ–≤. –ë–ª–∞–≥–æ–¥–∞—Ä—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, —Ç–∞–∫ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å—Ü–µ–Ω—ã, PSPNet –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ø–µ—Ä–µ–¥–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ä–∞–∑–±–∏–µ–Ω–∏–∏ —Å–ª–æ–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç—ã.

- `Multi-Attention Network (MANet)` ‚Äì –º–æ–¥–µ–ª—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è, —Ç–∞–∫–∏—Ö –∫–∞–∫ –ø–æ–∑–∏—Ü–∏–æ–Ω–Ω–æ–µ –∏ –∫–∞–Ω–∞–ª—å–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ç–∏ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —É–ª—É—á—à–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –æ–±—ä–µ–∫—Ç–æ–≤, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏

</details>



## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –∫–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç—Ä–∏–π
git clone https://github.com/mskv99/mb-opc.git
cd mb-opc

# —Å–æ–∑–¥–∞—ë–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é conda
conda create -n myenv python=3.10
conda activate myenv

# —Å–∫–∞—á–∏–≤–∞–µ–º poetry –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
pip install poetry
# –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å poetry —Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
poetry config virtualenvs.create false
# —É—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
poetry install
```
–ü–æ–¥–≥—Ä—É–∑–∏–º –¥–∞–Ω–Ω—ã–µ –∏ –≤–µ—Å–∞ –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é `dvc`. 
–î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º —Ñ–∞–π–ª —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º `dvc-storage.json`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É.
–î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `configs`. –ü–æ—Å–ª–µ —á–µ–≥–æ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –ø–æ–¥–≥—Ä—É–∑–∏–º –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
# –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –≤—Ä–µ–º—è, –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –æ–∫–æ–ª–æ 12–ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—É–º–µ–Ω—å—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ `data/processed/gds_dataset`
dvc pull -r gdrive_data data/processed/gds_dataset.dvc

# –ø–æ–¥–≥—Ä—É–∑–∏–º –≤–µ—Å–∞ –æ–¥–Ω–æ–π –∏–∑ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —Å –ø–æ–º–æ—â—å—é dvc:
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ –≤–µ—Å–∞ –±—É–¥—É—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ `checkpoints/upernet.ckpt`
dvc pull -r gdrive_models checkpoints/upernet.ckpt.dvc

# –ø–æ–¥–≥—Ä—É–∑–∏–º —Ç–∞–∫–∂–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤ onnx –º–æ–¥–µ–ª—å
dvc pull -r gdrive_models checkpoints/exported_model.onnx.dvc

# –ø–æ–¥–≥—Ä—É–∑–∏–º .pth –≤–µ—Å–∞
dvc pull -r gdrive_models checkpoints/unet_concat_checkpoint.pth.dvc
```


```bash
# —É–±–µ–¥–∏–º—Å—è –≤ –æ—Ç—Å—É—Ç—Å–≤–∏–∏ –¥–æ—Å–∞–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫:
pre-commit run --all
```

## üèãÔ∏è –û–±—É—á–µ–Ω–∏–µ

1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–∑–æ–≤**:

```bash
# –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è:
python src/train.py
```

–í –∫–∞—á–µ—Å—Ç–≤–µ CLI –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º **Hydra**. –°–æ–æ—Ç–≤–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏ –º–æ–∂–Ω–æ
–Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `configs`.

–û—Å–Ω–æ–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

- `model` - –≤—ã–±–∏—Ä–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—É—é –∏–∑ –º–æ–¥–µ–ª—å –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö [`unet`, `cfno`,
  `pspnet`, `manet`, `upernet`]. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `UNet` –±–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
  `skip-connections`
- `optim` - —Ç–∏–ø –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `Adam`.
- `lr` - learning rate. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `2e-4`
- `weight_decay` - weight_decay. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1e-5`
- `sched` - —Ç–∏–ø –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `CosineAnnealing`
- `eta_min` - –∑–Ω–∞—á–µ–Ω–∏–µ learning rate –≤ –∫–æ–Ω—Ü–µ –æ–±—É—á–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1e-7`
- `epochs` - —á–∏—Å–ª–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `50`
- `batch_size` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `6`
- `device` - device. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `gpu`
- `num_workers` - —á–∏—Å–ª–æ –≤–æ—Ä–∫–µ—Ä–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `8`
- `iou_weight` - –≤–µ—Å —É IoU-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1`
- `bce_weight` - –≤–µ—Å —É BCE-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `1`

2. **–ü–µ—Ä–µ–¥–∞—ë–º —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:

```bash
python src/train.py model=manet training.epochs=10 training.batch_size=10 optim.lr=2e-5
```

üëÜ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫–∞–µ–º –æ–±—É—á–µ–Ω–∏–µ `manet` –Ω–∞ `10` —ç–ø–æ—Ö c
—Ä–∞–∑–º–µ—Ä–æ–º –±–∞—Ç—á–∞ —Ä–∞–≤–Ω—ã–º 10 –∏ learning rate —Ä–∞–≤–Ω—ã–º `2e-5`

üí° –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π, –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–æ–≤, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–≤ –ø—É—Ç—ë–º —Å–æ–∑–¥–∞–Ω–∏—è
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥-—Ñ–∞–π–ª–æ–≤. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ "–∫–æ–º–æ–ø–∑–∏—Ç–Ω—ã–µ"
—Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å (–ø–æ–¥–æ–±–Ω–æ IouBceLoss) —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

–ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å—Å—ã–ª–∫–µ –≤ `Weights and Biases`. –°—Å—ã–ª–∫–∞
–ø–æ—è–≤–∏—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –±—É–¥—É—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ø–∞–ø–∫—É `wandb/run-`, –∞ –≤–µ—Å–∞ –ª—É—á—à–µ–π
–º–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `logs/`

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

–û—Ü–µ–Ω–∏–º –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –Ω–∞ val/test. –í –∫–∞—á–µ—Å—Ç–≤–µ CLI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Fire**:

1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–∑–æ–≤**:

```bash
python src/evaluate.py --weights=/path/to/your/weights.ckpt --model_type=your_model_type
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `weights` - –ø—É—Ç—å –¥–æ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç
- `data` - –ø—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:
  `data/processed/gds_dataset`
- `subset` - —Ç–∏–ø –≤—ã–±–æ—Ä–∫–∏ va/test. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `test`
- `batch_size` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `2`
- `num_workers` - —á–∏—Å–ª–æ –≤–æ—Ä–∫–µ—Ä–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4`
- `model_type` - —Ç–∏–ø –º–æ–¥–µ–ª–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `upernet`

‚ö†Ô∏è –õ—É—á—à–µ —Å—Ç–∞—Ä–∞—Ç—å—Å—è —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ç–∏–ø –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
device –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ `mps`
(macOs), –ø–æ—ç—Ç–æ–º—É –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ `gpu` –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cpu`.

2. **–ü–µ—Ä–µ–¥–∞—ë–º —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:

```bash
python src/evaluate.py --weights=checkpoints/upernet.ckpt --subset=test --batch_size=5 --model_type=upernet
```

## üîÆ –ò–Ω—Ñ–µ—Ä–µ–Ω—Å

1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–∑–æ–≤**

```bash
python src/inference.py --weights=/path/to/your/weights.ckpt --model_type=your_model_type
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

- `weights` - –ø—É—Ç—å –¥–æ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç
- `inference_folder` - –ø—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏(–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ç–æ–ø–æ–ª–æ–≥–∏–π). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:
  `data/processed/gds_dataset/origin/test_origin`
- `output_folder` - –ø—É—Ç—å –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  –º–∞—Å–æ—á–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ü–∏–π. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `inference/output_img/`. –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
  –æ—Ç—Å—É—Ç—Å–≤—É–µ—Ç, —Ç–æ –æ–Ω–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è
  –≤ –ø–∞–ø–æ–∫ exp\_{i} –≤–Ω—É—Ç—Ä–∏ –¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- `batch_size` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `2`
- `num_workers` - —á–∏—Å–ª–æ –≤–æ—Ä–∫–µ—Ä–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `4`
- `model_type` - —Ç–∏–ø –º–æ–¥–µ–ª–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `upernet`

‚ö†Ô∏è –õ—É—á—à–µ —Å—Ç–∞—Ä–∞—Ç—å—Å—è —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ç–∏–ø –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
device –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –Ω–∞ `mps`
(macOs), –ø–æ—ç—Ç–æ–º—É –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ `gpu` –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cpu`.

2. **–ü–µ—Ä–µ–¥–∞—ë–º —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:

```bash
python src/inference.py --weights=checkpoints/upernet.ckpt --model_type=upernet --batch_size=10
```

## ‚ö° ONNX

–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –≤ **onnx** —Ñ–æ—Ä–º–∞—Ç

```bash
python python models/to_onnx.py --raw_weights=/path/to/your/weights.ckpt --onnx_weights=/path/to/save/onnx/weights.onnx
```

‚ö†Ô∏è –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –º–æ–¥–µ–ª–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
segmentation_models_pytorch, —Ç–∞–∫ –∫–∞–∫ –≤ –Ω–∏—Ö –µ—Å—Ç—å —Å–ª–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –ø—É–ª–ª–∏–Ω–≥–∞,
–∫–æ—Ç–æ—Ä—ã–π –Ω–µ –æ—á–µ–Ω—å –¥—Ä—É–∂–∏—Ç —Å onnx. –ü–æ–∫–∞ –Ω–µ —É—Å–ø–µ–ª –∏—Å–ø—Ä–∞–≤–∏—Ç—å. –í —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π
—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `unet` —Ç–∞–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å.

## –ú–µ—Ç—Ä–∏–∫–∏

–ö–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ü–µ–Ω–∏–≤–∞–ª–æ—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫ **Pixel
Accuracy** –∏ **IoU** (Intersection over Union). –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞–ª–æ—Å—å
—Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –º–∞—Å–æ—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π.

## –ì—Ä–∞—Ñ–∏–∫–∏

–ü–æ –º–µ—Ä–µ —Ä–∞–±–æ—Ç—ã –≤ [—ç—Ç–æ–º](https://api.wandb.ai/links/ml_team_mskv/6kunkn1r) –æ—Ç—á—ë—Ç–µ
–±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
|                                             | **Parameters** | **PixelAccuracy** | **IoU**    | **runtime, c** |
|:-------------------------------------------:|:--------------:|:-----------------:|:----------:|:--------------:|
| **Baseline (DAMO generator)**               | 97.5M          | 0.9992            | 0.9931     | 0.023          |
| **DAMO generator (skip-connections - add)** | 97.5M          | 0.9991            | 0.9933     | 0.022          |
| **DAMP (skip-connections - concat)**        | 99.1M          | 0.9991            | 0.9933     | 0.021          |
| **CFNO**                                    | 1.8M           | 0.9971            | 0.9752     | 0.026          |
| **PSPNet**                                  | 21.4M          | 0.9979            | 0.9802     | **0.014**      |
| **MANet**                                   | 31.7M          | **0.9994**        | **0.9955** | 0.020          |
| **UperNet**                                 | 29.6M          | 0.9994            | 0.9953     | 0.015          |


## –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞

1. Zheng S. [–∏ –¥—Ä.]. LithoBench: Benchmarking AI Computational Lithography for
   Semiconductor Manufacturing –ø–æ–¥ —Ä–µ–¥. A. Oh [–∏ –¥—Ä.]., Curran Associates, Inc.,
   2023.C. 30243‚Äì30254.
   [[c—Ç–∞—Ç—å—è](http://www.cse.cuhk.edu.hk/~byu/papers/C190-NeurIPS2023-LithoBench.pdf)];
   [[—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/shelljane/lithobench)]
2. Chen G. [–∏ –¥—Ä.]. DAMO: Deep Agile Mask Optimization for Full Chip Scale 2020.
   [[—Å—Ç–∞—Ç—å—è](https://www.cse.cuhk.edu.hk/~byu/papers/C104-ICCAD2020-DAMO.pdf)]
3. Yang H., Ren H. Enabling Scalable AI Computational Lithography with
   Physics-Inspired Models Tokyo Japan: ACM, 2023.C. 715‚Äì720.
   [[—Å—Ç–∞—Ç—å—è](https://d1qx31qr3h6wln.cloudfront.net/publications/Enabling_Scalable_AI_Computational_Lithography_with_Physics-Inspired_Models.pdf)]
4. Zhao H., Shi J., Qi X., Wang X., Jia J. Pyramid Scene Parsing Network. ‚Äî arXiv, 2016.
5. Li R., Zheng S., Zhang C., Duan C., Su J., Wang L., Atkinson P.M. Multiattention Network for Semantic Segmentation of Fine-Resolution Remote Sensing Images // IEEE Transactions on Geoscience and Remote Sensing. ‚Äî   2022. ‚Äî   –¢. 60. ‚Äî   C. 1-13 
